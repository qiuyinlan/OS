# ROM与RAM

[[BIOS]] [[内存]] [[硬件]] [[闪存]]

## ROM - 只读存储器

**ROM (Read-Only Memory, 只读存储器)** 是一种**非易失性存储**，断电后数据不会丢失。

### ROM 的技术定义

1. **出厂后内容"不可修改"或"极难修改"**
   - 数据通过"掩膜工艺"固化在芯片中
   - 断电后数据永久保留
   - 用户无法像修改文件一样改写内容

2. **容量小、速度快**（相对硬盘）
   - 通常只有几 KB 到几 MB
   - 用于存储"最底层、固定不变"的程序

3. **芯片级存储**
   - 直接焊接在主板/芯片上
   - 不是独立的"盘状设备"

### ROM 的类型

| 类型 | 全称 | 特点 |
|-----|------|------|
| Mask ROM | 掩膜 ROM | 工厂生产时固化，完全不可改写 |
| PROM | 可编程 ROM | 用户可编程一次，之后不可改 |
| EPROM | 可擦除可编程 ROM | 用紫外线擦除后可重新编程 |
| EEPROM | 电可擦除可编程 ROM | 用电信号擦除和编程 |
| Flash | 闪存 | EEPROM 的改进版，现代主流 |

### ROM 的用途

#### 1. BIOS/UEFI

- 电脑主板上有专门的 ROM 芯片（现在多是 Flash）
- 存储 [[BIOS]] 程序
- CPU 上电后直接执行 ROM 中的 BIOS 代码

#### 2. 手机 BootROM

- 集成在主芯片（如高通骁龙、苹果 A 系列）里
- 存储启动代码和安全验证
- 一般不可修改

#### 3. 嵌入式设备

- 路由器、打印机、家电等
- 固化的操作系统或控制程序

## RAM - 随机存取存储器

**RAM (Random Access Memory, 随机存取存储器)** 是**易失性存储**，断电后数据丢失。

### RAM 的特点

1. **易失性**
   - 断电后内容全部丢失
   - 开机时需要重新加载

2. **高速读写**
   - 比硬盘/ROM 快得多
   - CPU 直接访问

3. **容量大**（相对 ROM）
   - 现代电脑通常 8GB ~ 64GB

### RAM 的类型

| 类型 | 全称 | 特点 |
|-----|------|------|
| SRAM | 静态 RAM | 速度快，常用于 CPU 缓存 |
| DRAM | 动态 RAM | 需要刷新，容量大，用于主内存 |
| DDR | 双倍数据速率 RAM | 现代主内存（DDR3/DDR4/DDR5）|

### RAM 的用途

1. **程序运行的工作空间**
   - 操作系统加载到 RAM
   - 程序执行时的数据存储

2. **CPU 缓存**
   - L1/L2/L3 缓存使用 SRAM
   - 加速 CPU 访问内存

参见：[[寄存器]] [[CPU执行指令]]

## ROM vs RAM 对比

| 特性 | ROM | RAM |
|-----|-----|-----|
| 易失性 | 非易失（断电不丢数据）| 易失（断电丢数据）|
| 速度 | 较慢 | 很快 |
| 容量 | 小（KB~MB）| 大（GB 级别）|
| 可写性 | 不可写或难以改写 | 随时可读写 |
| 用途 | BIOS、固件 | 程序运行空间 |
| 价格 | 较贵（单位容量）| 较便宜 |

## 内存映射

### ROM 和 RAM 都在内存地址空间

在 [[实模式]] 下（1MB 地址空间）：

| 地址范围 | 类型 | 用途 |
|---------|------|------|
| 0x00000 - 0x9FFFF | RAM | 可用内存（640KB）|
| 0xA0000 - 0xBFFFF | RAM | 显存（128KB）|
| 0xC0000 - 0xFFFFF | ROM | BIOS ROM（256KB）|

- CPU 通过地址访问不同存储设备
- ROM 和 RAM 都被映射到同一个地址空间
- CPU 不关心是 ROM 还是 RAM，只管地址

### 为什么 ROM 不需要加载？

- ROM 通过**内存映射**直接出现在地址空间
- CPU 上电后 CS:IP = 0xF000:0xFFF0，直接指向 ROM
- CPU 从 ROM 取指令，不需要"加载"到其他地方

参见：[[BIOS]] [[0启动流程]]

## 闪存 (Flash)

**闪存**是一种特殊的存储介质，介于 ROM 和 RAM 之间：

- **非易失性**：断电不丢数据（像 ROM）
- **可擦写**：可以多次擦写（比传统 ROM 灵活）
- **速度**：比机械硬盘快，但比 RAM 慢
- **容量**：比 RAM 大，比机械硬盘小

### 闪存的应用

#### 1. 固态硬盘（SSD）

- 使用 **NAND 闪存芯片**
- 替代机械硬盘，速度更快
- 存储操作系统、软件、文件

#### 2. U 盘、SD 卡

- 便携式存储设备
- 使用闪存芯片

#### 3. BIOS/UEFI 芯片

- 现代主板的 BIOS 存储在 **Flash ROM** 中
- 可以通过"刷 BIOS"更新

#### 4. 手机存储 (UFS/eMMC)

- 手机的"内部存储"使用闪存
- 存储系统、应用、照片等

### 为什么不用闪存替代内存？

| 特性 | 闪存 | RAM (DDR) |
|-----|------|-----------|
| 读写速度 | ~7GB/s | ~50GB/s |
| 写入次数 | 有限（几千~几万次）| 无限 |
| 延迟 | 较高 | 极低 |
| 价格 | 便宜 | 贵 |

- 闪存速度远不如 RAM
- RAM 用于"临时存储正在运行的程序"
- 闪存用于"长期存储文件"

## 电脑的存储层次

```
速度快 ←→ 速度慢
容量小 ←→ 容量大

CPU 寄存器 (几十个)
    ↓
L1 缓存 (SRAM, 几十KB)
    ↓
L2/L3 缓存 (SRAM, 几MB)
    ↓
RAM 内存 (DRAM, 几GB~几十GB)
    ↓
SSD 固态硬盘 (闪存, 几百GB~几TB)
    ↓
机械硬盘 (HDD, 几TB)
```

参见：[[CPU执行指令]] [[寄存器]]

## 手机存储

### BootROM

- **类型**：Mask ROM 或 OTP（一次性可编程）
- **位置**：集成在主芯片（SoC）内
- **作用**：存储启动代码、安全验证
- **特点**：完全不可修改

### 系统存储

- **类型**：UFS/eMMC（闪存）
- **作用**：存储操作系统、应用、数据
- **特点**：可读写、断电不丢数据

### 运行内存

- **类型**：LPDDR（低功耗 DDR）
- **作用**：程序运行的工作空间
- **特点**：易失性，断电丢数据

## 总结

### ROM（只读存储器）

- 非易失性，断电不丢数据
- 用于存储固件（BIOS、BootROM）
- 通常不可或难以改写

### RAM（随机存取存储器）

- 易失性，断电丢数据
- 高速读写
- 用于程序运行的工作空间

### 闪存 (Flash)

- 非易失性
- 可擦写
- 介于 ROM 和 RAM 之间
- 用于 SSD、U 盘、手机存储

参见：[[内存]] [[BIOS]] [[硬件]]
