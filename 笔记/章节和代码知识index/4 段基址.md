16bit
1个对应4位。
2个，8位

[[c4代码]]
[[0汇编语法]]
# 问题

## 2.0为什么mbr是512字节

1. BIOS 读取硬盘的原理

- BIOS 是电脑上最早执行的程序，它运行在 **实模式（Real Mode）** 下。
    
- 在实模式下，CPU 访问内存和设备非常受限：
    
    - 内存只能访问 1MB 内存；
        
    - I/O 访问用的是 **端口方式**（in/out 指令）；
        
- BIOS 通过 **中断 13h**（INT 13h）接口访问硬盘。
    
    - 这是 IBM PC/AT 兼容机的标准。
        
    - ==INT 13h 提供的最小读取单位就是 **一个扇区==（Sector）**。
        
    - 传统硬盘的扇区大小 = **512 字节**。

mBr是512字节，是因为第0扇区就是512字节的原因

## 3.0  讲一下段基址和偏移量

因为实模式下寄存器是16位
段寄存器里的段基址乘以16,就是补了4位二进制，1位16进制。
此时，表面上总共有20位，舍弃最后一位，表面上再补上舍弃的一位16进制就够了，但是这样每次只能偏移16bit，太少了，所以，用16位寄存器，偏移16的4次方bit,更大，更适合。
2的20次方是1M,2的16次方是64kb


## 4.0


## 为什么需要保护模式

1M太少了，且要防止破坏，没有保护，也没有特权级。
保护模式下：访问数据，cpu会检查GDT表,如果可以才能访问，有问题就直接抛出异常。

## 保护模式下内存是怎么管理的

实模式下，寄存器存储的是段基址，它\*16+偏移量就是物理地址。
保护模式下，它存储的是段选择子

###  段选择子工作原理

[[段选择子]]

###  讲一下段与全局描述符表

[[段描述符]]
[[GDT-GDTR-LGDT]]





###  处理器微架构与指令执行

保护模式下，CPU 的流水线、乱序执行、缓存和分支预测是如何影响指令执行的？为什么要使用远跳转指令刷新流水线？
[[cpu执行指令]]

### **内存段保护与栈操作**  

在保护模式下，段寄存器加载选择子、代码段/数据段、栈段的保护机制是怎样的？push 指令在保护模式和实模式下有什么不同？

[[段选择子]]
[[段保护机制]]


# loader以及各部分的功能

Loader 可以分阶段：

1. **第一阶段**：MBR（512 字节）
MBR 作为第一阶段 loader，能先搭建一个**可执行的环境**，
- MBR 只有 **512 字节**，而整个内核可能是 **几 KB 到几 MB**。
    
- 512 字节太小，根本放不下完整的内核加载器代码。
    
- 因此必须分阶段：第一阶段 loader（MBR）**：小，能在 BIOS 直接加载的范围内完成最基本任务（比如找到内核、设置栈、调用 BIOS 读硬盘）。**第二阶段 loader**：在 MBR 的帮助下加载更大、更复杂的内核。

2. **第二阶段**：稍大一点的程序，负责完整加载内核
    
3. **第三阶段（可选）**：高级 loader，比如 GRUB




